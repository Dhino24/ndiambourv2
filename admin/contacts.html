<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Contacts - Ndiambour Location</title>
  <link rel="shortcut icon" href="../img/logo.png" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css">
  <link rel="stylesheet" href="../admin/admin.css">
</head>
<body>
  <div class="d-flex" id="wrapper">
    <!-- Sidebar -->
    <div class="bg-white border-end" id="sidebar-wrapper">
      <div class="sidebar-heading p-3 border-bottom">
        <img src="../img/logo.png" alt="Ndiambour" height="40">
        <span class="ms-2 fw-bold">Admin</span>
      </div>
      <div class="list-group list-group-flush">
        <a class="list-group-item list-group-item-action p-3" href="index.html"><i class="fas fa-tachometer-alt me-2"></i>Dashboard</a>
        <a class="list-group-item list-group-item-action p-3" href="vehicles.html"><i class="fas fa-car me-2"></i>Véhicules</a>
        <a class="list-group-item list-group-item-action p-3" href="reservations.html"><i class="fas fa-calendar-check me-2"></i>Réservations</a>
        <a class="list-group-item list-group-item-action p-3 active" href="contacts.html"><i class="fas fa-address-book me-2"></i>Contacts</a>
        <a class="list-group-item list-group-item-action p-3" href="../index.html" target="_blank"><i class="fas fa-eye me-2"></i>Voir site</a>
      </div>
    </div>
    
    <!-- Content -->
    <div id="page-content-wrapper">
      <!-- Top nav -->
      <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
        <div class="container-fluid">
          <button class="btn btn-sm btn-primary" id="sidebarToggle"><i class="fas fa-bars"></i></button>
          <div class="ms-auto">
            <div class="dropdown">
              <a class="dropdown-toggle text-decoration-none text-dark" href="#" data-bs-toggle="dropdown"><i class="fas fa-user-circle me-1"></i>Admin</a>
              <ul class="dropdown-menu dropdown-menu-end">
                <li><a class="dropdown-item" href="#">Profil</a></li>
                <li><a class="dropdown-item" href="#">Paramètres</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="../login.html">Déconnexion</a></li>
              </ul>
            </div>
          </div>
        </div>
      </nav>
      
      <!-- Main -->
      <div class="container-fluid p-4">
        <h1 class="h2 mb-4">Gestion des Contacts</h1>
        
        <!-- Stats -->
        <div class="row mb-4">
          <div class="col-md-3 mb-3">
            <div class="card border-0 shadow-sm">
              <div class="card-body d-flex">
                <div class="rounded-circle bg-primary bg-opacity-10 p-3 me-3"><i class="fas fa-envelope text-primary fa-2x"></i></div>
                <div>
                  <h6 class="text-muted mb-1">Total</h6>
                  <h4 class="mb-0" id="total-messages">0</h4>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="card border-0 shadow-sm">
              <div class="card-body d-flex">
                <div class="rounded-circle bg-warning bg-opacity-10 p-3 me-3"><i class="fas fa-clock text-warning fa-2x"></i></div>
                <div>
                  <h6 class="text-muted mb-1">Non lus</h6>
                  <h4 class="mb-0" id="unread-count">0</h4>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="card border-0 shadow-sm">
              <div class="card-body d-flex">
                <div class="rounded-circle bg-success bg-opacity-10 p-3 me-3"><i class="fas fa-check-circle text-success fa-2x"></i></div>
                <div>
                  <h6 class="text-muted mb-1">Traités</h6>
                  <h4 class="mb-0" id="processed-count">0</h4>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="card border-0 shadow-sm">
              <div class="card-body d-flex">
                <div class="rounded-circle bg-info bg-opacity-10 p-3 me-3"><i class="fas fa-reply text-info fa-2x"></i></div>
                <div>
                  <h6 class="text-muted mb-1">Aujourd'hui</h6>
                  <h4 class="mb-0" id="today-count">0</h4>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Table -->
        <div class="card border-0 shadow-sm">
          <div class="card-body">
            <table id="contacts-table" class="table table-striped w-100">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Date</th>
                  <th>Nom</th>
                  <th>Email</th>
                  <th>Sujet</th>
                  <th>Statut</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>C001</td>
                  <td>2025-03-17</td>
                  <td>Amadou Diop</td>
                  <td>amadou@example.com</td>
                  <td>Demande d'information</td>
                  <td><span class="badge bg-warning">Non lu</span></td>
                  <td>
                    <div class="d-flex gap-1">
                      <button class="btn btn-sm btn-primary view-msg" data-id="C001"><i class="fas fa-eye"></i></button>
                      <button class="btn btn-sm btn-danger del-msg" data-id="C001"><i class="fas fa-trash"></i></button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td>C002</td>
                  <td>2025-03-16</td>
                  <td>Fatou Ndiaye</td>
                  <td>fatou@example.com</td>
                  <td>Réservation Toyota</td>
                  <td><span class="badge bg-success">Traité</span></td>
                  <td>
                    <div class="d-flex gap-1">
                      <button class="btn btn-sm btn-primary view-msg" data-id="C002"><i class="fas fa-eye"></i></button>
                      <button class="btn btn-sm btn-danger del-msg" data-id="C002"><i class="fas fa-trash"></i></button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td>C003</td>
                  <td>2025-03-17</td>
                  <td>Ibrahima Sall</td>
                  <td>ibra@example.com</td>
                  <td>Question tarifs</td>
                  <td><span class="badge bg-warning">Non lu</span></td>
                  <td>
                    <div class="d-flex gap-1">
                      <button class="btn btn-sm btn-primary view-msg" data-id="C003"><i class="fas fa-eye"></i></button>
                      <button class="btn btn-sm btn-danger del-msg" data-id="C003"><i class="fas fa-trash"></i></button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Message Modal -->
  <div class="modal fade" id="msgModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="msg-subject">Sujet</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="row mb-3">
            <div class="col-md-6">
              <p class="mb-1"><strong>De:</strong> <span id="msg-name"></span></p>
              <p class="mb-1"><strong>Email:</strong> <span id="msg-email"></span></p>
            </div>
            <div class="col-md-6 text-md-end">
              <p class="mb-1"><strong>Tél:</strong> <span id="msg-phone"></span></p>
              <p class="mb-1"><strong>Date:</strong> <span id="msg-date"></span></p>
            </div>
          </div>
          <div class="mb-3">
            <div class="p-3 bg-light rounded">
              <p id="msg-content"></p>
            </div>
          </div>
          <div class="mb-3">
            <label class="form-label">Réponse</label>
            <textarea class="form-control" id="msg-reply" rows="5"></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
          <button type="button" class="btn btn-success" id="mark-read">Lu</button>
          <button type="button" class="btn btn-primary" id="send-reply">Répondre</button>
        </div>
      </div>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
  <script src="../js/admin.js"></script>
  <script>
    // Init
    $(document).ready(function() {
      // DataTable
      $('#contacts-table').DataTable({
        language: {url: '//cdn.datatables.net/plug-ins/1.13.4/i18n/fr-FR.json'},
        order: [[1, 'desc']]
      });
      
      // Stats
      $('#total-messages').text('3');
      $('#unread-count').text('2');
      $('#processed-count').text('1');
      $('#today-count').text('2');
      
      // Messages
      const msgs = {
        C001: {
          subject: "Demande d'information",
          name: "Amadou Diop",
          email: "amadou@example.com",
          phone: "+221 77 123 45 67",
          date: "17/03/2025",
          content: "Bonjour, je souhaite avoir plus d'informations sur vos services de location. Quels sont vos tarifs pour une location de SUV pour une semaine? Merci."
        },
        C002: {
          subject: "Réservation Toyota",
          name: "Fatou Ndiaye",
          email: "fatou@example.com",
          phone: "+221 76 987 65 43",
          date: "16/03/2025",
          content: "Bonjour, je souhaite réserver le Toyota Land Cruiser pour la période du 25 au 30 mars. Est-ce possible? Merci."
        },
        C003: {
          subject: "Question tarifs",
          name: "Ibrahima Sall",
          email: "ibra@example.com",
          phone: "+221 70 456 78 90",
          date: "17/03/2025",
          content: "Bonjour, je voudrais connaître vos tarifs pour une location longue durée (3 mois) d'une berline Mercedes. Proposez-vous des réductions? Cordialement."
        }
      };
      
      // View message
      $('.view-msg').click(function() {
        const id = $(this).data('id');
        const msg = msgs[id];
        $('#msg-subject').text(msg.subject);
        $('#msg-name').text(msg.name);
        $('#msg-email').text(msg.email);
        $('#msg-phone').text(msg.phone);
        $('#msg-date').text(msg.date);
        $('#msg-content').text(msg.content);
        $('#msg-reply').val('');
        new bootstrap.Modal($('#msgModal')).show();
      });
      
      // Delete
      $('.del-msg').click(function() {
        if(confirm('Supprimer ce message?')) {
          $(this).closest('tr').remove();
          $('#total-messages').text(parseInt($('#total-messages').text())-1);
        }
      });
      
      // Mark read
      $('#mark-read').click(function() {
        alert('Message marqué comme lu');
        bootstrap.Modal.getInstance($('#msgModal')).hide();
      });
      
      // Reply
      $('#send-reply').click(function() {
        const reply = $('#msg-reply').val();
        if(!reply.trim()) {
          alert('Veuillez saisir une réponse');
          return;
        }
        alert('Réponse envoyée');
        bootstrap.Modal.getInstance($('#msgModal')).hide();
      });
    });
  </script>
</body>
</html>
